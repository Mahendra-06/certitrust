{"ast":null,"code":"import{Navigate,useLocation,useParams}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ProtectedRoute(_ref){let{children,allowedRoles}=_ref;const{user,isAuthenticated,isLoading}=useAuth();const location=useLocation();const{userType}=useParams();// Show loading state while checking auth\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen\",children:\"Loading...\"});}// If not authenticated, redirect to login\nif(!isAuthenticated||!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/user-type\",state:{from:location},replace:true});}// Check if the user's role has access to this route\nconst hasRequiredRole=allowedRoles?allowedRoles.includes(user.role):true;const isMatchingRoute=!userType||user.role===userType;// If role doesn't match, redirect to the appropriate dashboard\nif(!isMatchingRoute){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard/\".concat(user.role),replace:true});}// If role is not allowed, show access denied\nif(!hasRequiredRole){return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center min-h-screen p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative max-w-md w-full text-center\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"font-bold\",children:\"Access Denied! \"}),/*#__PURE__*/_jsx(\"span\",{className:\"block sm:inline\",children:\"You don't have permission to access this page.\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.history.back(),className:\"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\",children:\"Go Back\"})]});}// If all checks pass, render the protected content\nreturn children;}","map":{"version":3,"names":["Navigate","useLocation","useParams","useAuth","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","children","allowedRoles","user","isAuthenticated","isLoading","location","userType","className","to","state","from","replace","hasRequiredRole","includes","role","isMatchingRoute","concat","onClick","window","history","back"],"sources":["D:/SIH prototype/Frontend/src/components/ProtectedRoute.tsx"],"sourcesContent":["import { Navigate, useLocation, useParams } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\n\ntype ProtectedRouteProps = {\n  children: JSX.Element;\n  allowedRoles?: string[];\n};\n\nexport default function ProtectedRoute({ children, allowedRoles }: ProtectedRouteProps) {\n  const { user, isAuthenticated, isLoading } = useAuth();\n  const location = useLocation();\n  const { userType } = useParams<{ userType?: string }>();\n\n  // Show loading state while checking auth\n  if (isLoading) {\n    return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\n  }\n\n  // If not authenticated, redirect to login\n  if (!isAuthenticated || !user) {\n    return <Navigate to=\"/user-type\" state={{ from: location }} replace />;\n  }\n\n  // Check if the user's role has access to this route\n  const hasRequiredRole = allowedRoles ? allowedRoles.includes(user.role) : true;\n  const isMatchingRoute = !userType || user.role === userType;\n\n  // If role doesn't match, redirect to the appropriate dashboard\n  if (!isMatchingRoute) {\n    return <Navigate to={`/dashboard/${user.role}`} replace />;\n  }\n\n  // If role is not allowed, show access denied\n  if (!hasRequiredRole) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen p-4\">\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative max-w-md w-full text-center\">\n          <strong className=\"font-bold\">Access Denied! </strong>\n          <span className=\"block sm:inline\">You don't have permission to access this page.</span>\n        </div>\n        <button\n          onClick={() => window.history.back()}\n          className=\"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n        >\n          Go Back\n        </button>\n      </div>\n    );\n  }\n\n  // If all checks pass, render the protected content\n  return children;\n}\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,WAAW,CAAEC,SAAS,KAAQ,kBAAkB,CACnE,OAASC,OAAO,KAAQ,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAOlD,cAAe,SAAS,CAAAC,cAAcA,CAAAC,IAAA,CAAkD,IAAjD,CAAEC,QAAQ,CAAEC,YAAkC,CAAC,CAAAF,IAAA,CACpF,KAAM,CAAEG,IAAI,CAAEC,eAAe,CAAEC,SAAU,CAAC,CAAGX,OAAO,CAAC,CAAC,CACtD,KAAM,CAAAY,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEe,QAAS,CAAC,CAAGd,SAAS,CAAwB,CAAC,CAEvD;AACA,GAAIY,SAAS,CAAE,CACb,mBAAOT,IAAA,QAAKY,SAAS,CAAC,+CAA+C,CAAAP,QAAA,CAAC,YAAU,CAAK,CAAC,CACxF,CAEA;AACA,GAAI,CAACG,eAAe,EAAI,CAACD,IAAI,CAAE,CAC7B,mBAAOP,IAAA,CAACL,QAAQ,EAACkB,EAAE,CAAC,YAAY,CAACC,KAAK,CAAE,CAAEC,IAAI,CAAEL,QAAS,CAAE,CAACM,OAAO,MAAE,CAAC,CACxE,CAEA;AACA,KAAM,CAAAC,eAAe,CAAGX,YAAY,CAAGA,YAAY,CAACY,QAAQ,CAACX,IAAI,CAACY,IAAI,CAAC,CAAG,IAAI,CAC9E,KAAM,CAAAC,eAAe,CAAG,CAACT,QAAQ,EAAIJ,IAAI,CAACY,IAAI,GAAKR,QAAQ,CAE3D;AACA,GAAI,CAACS,eAAe,CAAE,CACpB,mBAAOpB,IAAA,CAACL,QAAQ,EAACkB,EAAE,eAAAQ,MAAA,CAAgBd,IAAI,CAACY,IAAI,CAAG,CAACH,OAAO,MAAE,CAAC,CAC5D,CAEA;AACA,GAAI,CAACC,eAAe,CAAE,CACpB,mBACEf,KAAA,QAAKU,SAAS,CAAC,4DAA4D,CAAAP,QAAA,eACzEH,KAAA,QAAKU,SAAS,CAAC,sGAAsG,CAAAP,QAAA,eACnHL,IAAA,WAAQY,SAAS,CAAC,WAAW,CAAAP,QAAA,CAAC,iBAAe,CAAQ,CAAC,cACtDL,IAAA,SAAMY,SAAS,CAAC,iBAAiB,CAAAP,QAAA,CAAC,gDAA8C,CAAM,CAAC,EACpF,CAAC,cACNL,IAAA,WACEsB,OAAO,CAAEA,CAAA,GAAMC,MAAM,CAACC,OAAO,CAACC,IAAI,CAAC,CAAE,CACrCb,SAAS,CAAC,2EAA2E,CAAAP,QAAA,CACtF,SAED,CAAQ,CAAC,EACN,CAAC,CAEV,CAEA;AACA,MAAO,CAAAA,QAAQ,CACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}